import pandas as pd
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd 
import statsmodels.api as sm

# ler a base regressão simples (MOnitoramento VS NPS)
df = pd.read_excel('Base de dados MOnit VS NPS.xlsx')

# definindo X e Y
x = df[['% MONITORAMENTO']]
y = df['NPS CRISTAL']
MonitReal = 0.94

# Cria o modelo modelo = sm.OLS(Y, X).fit()
modelo = sm.OLS(y,x).fit()
print(modelo.summary())

# CRIANDO E TREINANDO O MODELO
modelo = LinearRegression()
modelo.fit(x, y)

# gráfico de dispersão com linha de regressão
sns.scatterplot(x=x.squeeze(), y=y)
plt.plot(x, modelo.predict(x), color='red')
plt.title('Regressão: % Monitoramento vs NPS Cristal')
plt.xlabel('% MONITORAMENTO')
plt.ylabel('NPS CRISTAL')
plt.show()
input("Pressione Enter para continuar...")

# histograma do % MONITORAMENTO
sns.histplot(df['% MONITORAMENTO'], kde=True)
plt.title('Distribuição do % MONITORAMENTO')
plt.show()
input("Pressione Enter para continuar...")

# histograma do NPS CRISTAL
sns.histplot(df['NPS CRISTAL'], kde=True)
plt.title('Distribuição do NPS CRISTAL')
plt.show()
input("Pressione Enter para continuar...")

# RESULTADOS
print('Contribution (m):', modelo.coef_[0])
print('Intercepto (b):', modelo.intercept_)
print('R² (qualidade do ajuste):', modelo.score(x, y))
print('NPS predito para 95% de monitoramento:', modelo.predict([[MonitReal]])[0])

#print(df.head())
                                 OLS Regression Results                                
=======================================================================================
Dep. Variable:            NPS CRISTAL   R-squared (uncentered):                   0.980
Model:                            OLS   Adj. R-squared (uncentered):              0.979
Method:                 Least Squares   F-statistic:                              998.6
Date:                Mon, 05 Jan 2026   Prob (F-statistic):                    1.51e-18
Time:                        11:27:06   Log-Likelihood:                         -72.434
No. Observations:                  21   AIC:                                      146.9
Df Residuals:                      20   BIC:                                      147.9
Df Model:                           1                                                  
Covariance Type:            nonrobust                                                  
===================================================================================
                      coef    std err          t      P>|t|      [0.025      0.975]
-----------------------------------------------------------------------------------
% MONITORAMENTO    59.4225      1.880     31.600      0.000      55.500      63.345
==============================================================================
Omnibus:                        3.325   Durbin-Watson:                   2.405
Prob(Omnibus):                  0.190   Jarque-Bera (JB):                1.747
Skew:                          -0.669   Prob(JB):                        0.418
Kurtosis:                       3.454   Cond. No.                         1.00
==============================================================================

Notes:
[1] R² is computed without centering (uncentered) since the model does not contain a constant.
[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.
No description has been provided for this image
No description has been provided for this image
No description has been provided for this image
Contribution (m): 43.75090610845661
Intercepto (b): 14.19666510299453
R² (qualidade do ajuste): 0.01190646322215172
NPS predito para 95% de monitoramento: 55.32251684494374
C:\Users\jesse\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\sklearn\utils\validation.py:2691: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names
  warnings.warn(
 
